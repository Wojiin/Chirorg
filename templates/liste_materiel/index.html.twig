{% extends 'base.html.twig' %} {# Bloc principal du contenu de la page #} {%
block body %} {# Titre de la page listant toutes les listes de matériel #}
<h1>Listes de matériel</h1>

{# Lien vers la page de création d'une nouvelle liste de matériel #}
<a href="{{ path('liste_materiel_new') }}">Créer une liste</a>

<ul>
    {# Parcourt toutes les listes de matériel transmises par le contrôleur #} {%
    for l in listes %}
    <li>
        {# Intitulé de la liste avec lien vers la page détail #}
        <strong>
            <a href="{{ path('liste_materiel_show', { id: l.id }) }}">
                {{ l.intitule }}
            </a>
        </strong>

        {# Affichage du chirurgien associé si présent #} — {% if l.chirurgien %}
        <a href="{{ path('chirurgien_show', { id: l.chirurgien.id }) }}">
            {{ l.chirurgien.prenom }} {{ l.chirurgien.nom }}
        </a>
        {% else %} Chirurgien manquant {% endif %} {# Affiche le nombre de
        matériels associés à la liste #} ({{ l.materiels | length }} matériels)

        <br />

        {# Lien vers la page de modification de la liste #}
        <a href="{{ path('liste_materiel_edit', { id: l.id }) }}">Modifier</a>
        | {# Formulaire de suppression sécurisé par token CSRF #}
        <form
            method="post"
            action="{{ path('liste_materiel_delete', { id: l.id }) }}"
            style="display: inline"
        >
            {# Token CSRF pour sécuriser la suppression #}
            <input
                type="hidden"
                name="_token"
                value="{{ csrf_token('delete' ~ l.id) }}"
            />

            <button type="submit">Supprimer</button>
        </form>
    </li>

    {# Bloc exécuté si aucune liste n'existe #} {% else %}
    <li>Aucune liste.</li>
    {% endfor %}
</ul>

{% endblock %}
